$(document).ready(function(){WESendMailCoreJs.Initialize()});var WESendMailCoreJs={CurrSendMail:null,LoadingOpen:!1,Initialize:function(){for(Elem in OEConfWESendMail)WESendMailCoreJs.IniSendMail(Elem);$(document).ajaxError(function(){OECenterLoading.Close(),response=WEEdSiteCommon.GetLocalizableString(OEConfWESendMail[WESendMailCoreJs.CurrSendMail].SendMailResponse.NoPopupMessage),response+="\n - Error Ajax.",response!=""&&OEPopupModalJs.ShowModalPopup(response,WEInfoPage.RelativePath+"WEFiles/Image/warning.png")})},IniSendMail:function(n){var i=OEConfWESendMail[n].ScriptVersion;DataWESendMail=OEConfWESendMail[n];var r={beforeSubmit:this.showRequest,success:this.showResponse,data:null,url:WEInfoPage.RelativePath+"WEFiles/Server/WESendMail-v"+i+".php"},u=DataWESendMail.FormLinks.ButtonSubmitID,f=DataWESendMail.FormLinks.ElementsID,t=$("#"+u);t.size()<1||t.click(function(){return WEInfoPage.RenderMode!="Editor"?(WESendMailCoreJs.CurrSendMail=n,WESendMailCoreJs.submit(n,r)):alert(WEEdSiteCommon.HtmlDecode(OEVarText.ExecutionOnlyOnline)),!1})},submit:function(n,t){var r,u,i;return WEInfoPage.RenderMode=="Editor"?!1:WEInfoPage.PHPVersion==""||WEInfoPage.PHPVersion=="undefined"||WEInfoPage.PHPVersion==null?(alert("WESendMail : "+WEEdSiteCommon.HtmlDecode(OEVarText.NoPHP)),!1):(r=OEConfWESendMail[n].ScriptVersion,t.data={PagePath:WEInfoPage.PageAssociatePath,WESendMailID:n,Culture:WEInfoPage.Culture,RelativePath:WEInfoPage.RelativePath,OEVersion:r},!this.checkValidators(t))?!1:(u=OEConfWESendMail[n].FormLinks.ElementsID,i=WEFormSubmitter.GetCloneForm(u,t.data,t.url),!i)?!1:(OECenterLoading.Open(),i.ajaxSubmit(t),!1)},CleanFormFields:function(n){var i=OEConfWESendMail[n].FormLinks.ElementsID,t;for(ID in i)t=$("#"+ID).find(":input"),t.clearFields()},checkValidators:function(n){var t=!0,r,i,u;DataWESendMail=OEConfWESendMail[n.data.WESendMailID],r=DataWESendMail.FormLinks.ElementsID;for(ID in r)(i=$("#"+ID).find(":input"),i.size()<1)||(u=i.fieldValue(),WEFormValidator.Execute($("#"+ID),u,"OESZ_ValidatorToolTip")||(t=!1));return t||OECenterLoading.Close(),t},showRequest:function(){return!0},showResponse:function(n,t,i,r){var u,e,o,f;OECenterLoading.Close(),dataInit=n,n=n.substr(n.indexOf("{"),n.lastIndexOf("}")-n.indexOf("{")+1);try{n=JSON.parse(n),e=OEConfWESendMail[WESendMailCoreJs.CurrSendMail].SendMailResponse.PopupConfirm,o=OEConfWESendMail[WESendMailCoreJs.CurrSendMail].SendMailResponse.PageReturn,t=="success"?n.State=="success"?(e==!0&&(u=WEEdSiteCommon.GetLocalizableString(OEConfWESendMail[WESendMailCoreJs.CurrSendMail].SendMailResponse.OkpopupMessage),u+="<br /><br /><span style='font-size: 12px;font-style: italic;'>"+n.ErrorDescription+"<\/span>",u!=""&&OEPopupModalJs.ShowModalPopup(u,WEInfoPage.RelativePath+"WEFiles/Image/information2.png"),WESendMailCoreJs.CleanFormFields(WESendMailCoreJs.CurrSendMail)),o==!0&&(f=WEEdSiteCommon.LinkGetPath(OEConfWESendMail[WESendMailCoreJs.CurrSendMail].SendMailResponse.OkPageLink),f!=""&&(window.location=f))):(e==!0&&(u=WEEdSiteCommon.GetLocalizableString(OEConfWESendMail[WESendMailCoreJs.CurrSendMail].SendMailResponse.NoPopupMessage),u+="<br /><br /><span style='font-size: 12px;font-style: italic;'>"+n.State+" - "+n.ErrorDescription+"<\/span>",u!=""&&OEPopupModalJs.ShowModalPopup(u,WEInfoPage.RelativePath+"WEFiles/Image/warning.png")),o==!0&&(f=WEEdSiteCommon.LinkGetPath(OEConfWESendMail[WESendMailCoreJs.CurrSendMail].SendMailResponse.NoPageLink),f!=""&&(window.location=f))):(u=GetLocalizableString(OEConfWESendMail[WESendMailCoreJs.CurrSendMail].SendMailResponse.NoPopupMessage),u+="\nErreur Ajax",OEPopupModalJs.ShowModalPopup(u,WEInfoPage.RelativePath+"WEFiles/Image/warning.png")),r&&!r.attr("id")&&r.remove()}catch(s){u=WEEdSiteCommon.HtmlDecode(OEVarText.NoResponse)+"<br />"+n+"<br /><span style='font-size:12px'>Error :"+s.description+dataInit+"<\/span>",OEPopupModalJs.ShowModalPopup(u,WEInfoPage.RelativePath+"WEFiles/Image/warning.png")}}}